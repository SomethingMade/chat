<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Loopa Feed</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <!-- Google AdSense Script -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1234567890123456"
          crossorigin="anonymous"></script>
  <style>
    /* CSS Variables */
    :root {
      --bg-primary: #fafafa;
      --bg-secondary: #fff;
      --text-primary: #262626;
      --text-secondary: #8e8e8e;
      --border: #dbdbdb;
      --accent: #0095f6;
      --modal-bg: rgba(0, 0, 0, 0.6);
      --post-bg: #fff;
      --input-bg: #f0f0f0;
      --button-bg: #0095f6;
      --button-text: #fff;
    }
    [data-theme="dark"] {
      --bg-primary: #1a1a1a;
      --bg-secondary: #2d2d2d;
      --text-primary: #e0e0e0;
      --text-secondary: #a0a0a0;
      --border: #444;
      --accent: #4dabf7;
      --modal-bg: rgba(0, 0, 0, 0.8);
      --post-bg: #2d2d2d;
      --input-bg: #3a3a3a;
      --button-bg: #4dabf7;
      --button-text: #fff;
    }
    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      margin: 0;
      padding-bottom: 70px;
      transition: background 0.3s ease, color 0.3s ease;
    }
    ::-webkit-scrollbar { display: none; }

    /* Header */
    header {
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border);
      height: 54px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 16px;
      position: sticky;
      top: 0;
      z-index: 10;
      transition: background 0.3s ease, border 0.3s ease;
    }
    .logo {
      font-family: 'Lobster', cursive;
      font-size: 24px;
      font-weight: 600;
      color: var(--text-primary);
    }

    /* Drawer */
    #drawer {
      width: 280px;
      max-width: 80%;
      background: var(--bg-secondary);
      border-right: 1px solid var(--border);
      z-index: 40;
      transition: background 0.3s ease, border 0.3s ease;
    }
    .drawer-link {
      @apply flex items-center gap-3 py-2 px-4 rounded-lg text-base font-medium hover:bg-gray-100 hover:text-blue-500 transition;
      color: var(--text-primary);
    }
    .drawer-link:hover {
      background: var(--input-bg);
      color: var(--accent);
    }
    #dark-mode-toggle svg {
      width: 20px;
      height: 20px;
      stroke: var(--text-primary);
    }

    /* Earnings Section */
    .earnings-section {
      padding: 16px;
      background: var(--input-bg);
      border-radius: 8px;
      margin: 16px 0;
    }
    .earnings-section p {
      font-size: 14px;
      color: var(--text-primary);
    }
    .earnings-section button {
      background: var(--button-bg);
      color: var(--button-text);
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 14px;
      margin-top: 8px;
    }

    /* Bottom Navigation, Reels, Posts, Modals (unchanged styles) */
    .bottom-nav { /* Unchanged */ }
    .reels-container { /* Unchanged */ }
    .post {
      background: var(--post-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      margin-bottom: 16px;
      overflow: hidden;
      transition: background 0.3s ease, border 0.3s ease;
    }
    .ad-post {
      background: var(--post-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      margin-bottom: 16px;
      padding: 12px;
      text-align: center;
      transition: background 0.3s ease, border 0.3s ease;
    }
    .ad-post ins {
      display: block !important;
      margin: 0 auto;
    }
    .ad-post .ad-label {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 8px;
    }
    /* Other styles unchanged */
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <button id="burger" class="p-2 focus:outline-none">
      <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/>
      </svg>
    </button>
    <h1 class="logo">Loopa</h1>
    <div class="w-6"></div>
  </header>

  <!-- Drawer -->
  <div id="overlay" class="fixed inset-0 bg-black/60 opacity-0 pointer-events-none transition-opacity duration-300 z-30"></div>
  <aside id="drawer" class="fixed inset-y-0 left-0 w-64 max-w-[80%] -translate-x-full bg-white shadow-lg overflow-y-auto transition-transform duration-300 z-40">
    <div class="p-4 space-y-6">
      <div class="text-xl font-bold">Menu</div>
      <div class="flex items-center space-x-3">
        <img src="https://i.pravatar.cc/40" alt="avatar" class="rounded-full w-10 h-10"/>
        <div>
          <p class="font-medium">Hi, There!</p>
          <a href="profile.html" class="text-sm text-blue-500">View profile</a>
        </div>
      </div>
      <div class="earnings-section">
        <p>Your Earnings: $<span id="user-earnings">0.00</span></p>
        <button id="payout-btn" disabled>Request Payout</button>
      </div>
      <nav class="flex flex-col space-y-2">
        <a href="home.html" class="drawer-link">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l9-9 9 9v9a3 3 0 01-3 3h-4v-6H10v6H6a3 3 0 01-3-3v-9z"/>
          </svg>
          Home
        </a>
        <!-- Other drawer links unchanged -->
        <button id="dark-mode-toggle" class="drawer-link">
          <svg id="dark-mode-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
          </svg>
          Dark Mode
        </button>
        <button class="drawer-link text-red-500 text-left">Log out</button>
      </nav>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="max-w-md mx-auto p-4">
    <div class="flex items-center justify-between mb-4 px-2">
      <h2 class="text-lg font-semibold">Just Reels</h2>
      <a href="https://www.chatbase.co/chatbot-iframe/WadQfJamkW2Hl2U4NbGbH">
        <button id="ai-button" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white text-sm px-4 py-1 rounded-full flex items-center gap-2 hover:from-purple-600 hover:to-pink-600 transition">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <rect x="6" y="8" width="12" height="8" rx="2" ry="2"/>
            <circle cx="9" cy="12" r="1" fill="currentColor"/>
            <circle cx="15" cy="12" r="1" fill="currentColor"/>
            <path d="M12 16v2" stroke-linecap="round"/>
          </svg>
          NexoraAI
        </button>
      </a>
    </div>
    <div class="reels-container"></div>
    <div id="posts" class="space-y-4"></div>
  </main>

  <!-- Modals (unchanged) -->
  <div id="createModal" class="modal fixed inset-0 flex items-center justify-center bg-black/60 z-50 hidden">...</div>
  <div id="postInputModal" class="modal fixed inset-0 flex items-center justify-center bg-black/60 z-50 hidden">...</div>
  <div id="reelInputModal" class="modal fixed inset-0 flex items-center justify-center bg-black/60 z-50 hidden">...</div>
  <div id="reelViewerModal" class="reel-viewer-modal fixed inset-0 z-50 hidden">...</div>

  <!-- Bottom Navigation (unchanged) -->
  <nav class="bottom-nav" role="navigation" aria-label="Bottom Navigation">...</nav>

  <!-- Scripts -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBOyZ3As4GTuNvjemvPF_SpsC6m6vqtNhc",
      authDomain: "fire-b-a8878.firebaseapp.com",
      databaseURL: "https://fire-b-a8878.firebaseio.com",
      projectId: "fire-b-a8878",
      storageBucket: "fire-b-a8878.appspot.com",
      messagingSenderId: "658673187627",
      appId: "1:658673187627:web:6e4c29af661785f0afa36e"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    let currentUser = null;

    auth.onAuthStateChanged(user => {
      if (!user) return window.location.href = "index.html";
      currentUser = user;
      loadPosts();
      loadReels();
      loadUserEarnings();
    });

    // Drawer
    const burger = document.getElementById('burger');
    const overlay = document.getElementById('overlay');
    const drawer = document.getElementById('drawer');
    function openDrawer() {
      drawer.classList.remove('-translate-x-full');
      overlay.classList.remove('opacity-0', 'pointer-events-none');
    }
    function closeDrawer() {
      drawer.classList.add('-translate-x-full');
      overlay.classList.add('opacity-0', 'pointer-events-none');
    }
    burger.addEventListener('click', openDrawer);
    overlay.addEventListener('click', closeDrawer);
    drawer.querySelectorAll('.drawer-link').forEach(link => {
      link.addEventListener('click', closeDrawer);
    });

    // Dark Mode Toggle
    const darkModeToggle = document.getElementById('dark-mode-toggle');
    const darkModeIcon = document.getElementById('dark-mode-icon');
    function toggleDarkMode() {
      const isDarkMode = document.documentElement.getAttribute('data-theme') === 'dark';
      if (isDarkMode) {
        document.documentElement.removeAttribute('data-theme');
        darkModeIcon.innerHTML = `
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>
        `;
        darkModeToggle.querySelector('span') ? darkModeToggle.querySelector('span').textContent = 'Dark Mode' : darkModeToggle.appendChild(document.createTextNode(' Dark Mode'));
        localStorage.setItem('theme', 'light');
      } else {
        document.documentElement.setAttribute('data-theme', 'dark');
        darkModeIcon.innerHTML = `
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
        `;
        darkModeToggle.querySelector('span') ? darkModeToggle.querySelector('span').textContent = 'Light Mode' : darkModeToggle.appendChild(document.createTextNode(' Light Mode'));
        localStorage.setItem('theme', 'dark');
      }
    }
    darkModeToggle.addEventListener('click', toggleDarkMode);
    if (localStorage.getItem('theme') === 'dark') {
      document.documentElement.setAttribute('data-theme', 'dark');
      darkModeIcon.innerHTML = `
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
      `;
      darkModeToggle.querySelector('span') ? darkModeToggle.querySelector('span').textContent = 'Light Mode' : darkModeToggle.appendChild(document.createTextNode(' Light Mode'));
    }

    // Load User Earnings
    function loadUserEarnings() {
      const earningsEl = document.getElementById('user-earnings');
      const payoutBtn = document.getElementById('payout-btn');
      db.ref(`earnings/${currentUser.uid}`).on('value', snap => {
        const earnings = snap.val() || { total: 0 };
        earningsEl.textContent = earnings.total.toFixed(2);
        payoutBtn.disabled = earnings.total < 10; // Minimum $10 for payout
      });
      payoutBtn.addEventListener('click', async () => {
        const earnings = await db.ref(`earnings/${currentUser.uid}/total`).once('value').val();
        if (earnings >= 10) {
          // Placeholder for Stripe payout
          alert('Payout requested! Processing via Stripe...');
          // Example server-side call:
          /*
          fetch('/api/payout', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ uid: currentUser.uid, amount: earnings })
          }).then(response => {
            if (response.ok) {
              db.ref(`earnings/${currentUser.uid}/total`).set(0);
              alert('Payout processed!');
            }
          });
          */
        }
      });
    }

    // Load Posts with Ads
    async function loadPosts() {
      db.ref('posts').on('value', async snapshot => {
        const posts = snapshot.val() || {};
        const postsContainer = document.getElementById('posts');
        postsContainer.innerHTML = '';
        let postIndex = 0;

        for (const [postId, post] of Object.entries(posts).reverse()) {
          // Check eligibility for monetization
          const userRef = db.ref(`users/${post.uid}`);
          const userSnap = await userRef.once('value');
          const userData = userSnap.val() || { followers: 0 };
          const isEligible = userData.followers >= 500;

          // Render Post
          let originalPost = {};
          if (post.originalPostId) {
            const originalSnapshot = await db.ref(`posts/${post.originalPostId}`).once('value');
            originalPost = originalSnapshot.val() || {};
          }
          const isOwnPost = post.uid === currentUser.uid;
          const postEl = document.createElement('div');
          postEl.className = 'post';
          postEl.innerHTML = `
            <div class="post-header">
              <img src="${post.avatar}" class="w-8 h-8 rounded-full"/>
              <div class="flex-1">
                <p class="font-semibold text-sm">${post.name}${post.originalPostId ? ` (Reposted from ${originalPost.name || 'someone'})` : ''}</p>
                <span class="text-xs text-gray-500">${formatTimestamp(post.timestamp)}</span>
              </div>
              ${isOwnPost ? `
                <div class="flex gap-2">
                  <button class="edit-post-btn text-gray-500 p-1" data-id="${postId}" title="Edit">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11.5A1.5 1.5 0 005.5 20H17a2 2 0 002-2v-5M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
                    </svg>
                  </button>
                  <button class="delete-post-btn text-gray-500 p-1" data-id="${postId}" title="Delete">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                  </button>
                </div>` : `
                <button class="follow-btn bg-blue-500 text-white text-xs px-3 py-1 rounded-full hidden" data-user="${post.uid}">Follow</button>`}
            </div>
            ${post.imageUrl ? `<img src="${post.imageUrl}" class="post-image" alt="Post image"/>` : ''}
            <div class="post-content" id="content-${postId}">${post.content}</div>
            <div class="post-actions">
              <button class="like-btn" data-id="${postId}">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                </svg>
                <span id="like-count-${postId}" class="text-sm">0</span>
              </button>
              <button class="comment-btn" data-id="${postId}">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                </svg>
              </button>
              <button class="repost-btn" data-id="${postId}">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                </svg>
                <span id="repost-count-${postId}" class="text-sm">0</span>
              </button>
            </div>
            <div id="comments-${postId}" class="px-4 py-2 space-y-2"></div>
            <div class="px-4 py-2 border-t border-gray-200">
              <div class="flex items-center gap-2">
                <input type="text" placeholder="Write a comment..." class="comment-input flex-1 border-0 bg-gray-100 rounded-full px-4 py-2 text-sm focus:ring-0" data-id="${postId}"/>
                <button class="comment-btn bg-blue-500 text-white p-2 rounded-full" data-id="${postId}" title="Post Comment">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10l9-6 9 6-9 6-9-6z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 21V9l3-2 3 2v12"/>
                  </svg>
                </button>
              </div>
            </div>
          `;
          postsContainer.appendChild(postEl);

          // Track Ad Impressions for Eligible Users
          if (isEligible && isOwnPost) {
            db.ref(`post_impressions/${postId}`).on('value', snap => {
              const impressions = snap.val() || 0;
              const earnings = (impressions * 0.0085 * 0.55) / 1000; // 55% share
              db.ref(`earnings/${post.uid}`).update({
                total: firebase.database.ServerValue.increment(earnings)
              });
            });
          }

          // Insert Ad Post Every 3 Posts
          postIndex++;
          if (postIndex % 3 === 0) {
            const adEl = document.createElement('div');
            adEl.className = 'ad-post';
            adEl.innerHTML = `
              <div class="ad-label">Sponsored</div>
              <ins class="adsbygoogle"
                   style="display:block"
                   data-ad-client="ca-pub-1234567890123456"
                   data-ad-slot="1234567890"
                   data-ad-format="auto"
                   data-full-width-responsive="true"></ins>
            `;
            postsContainer.appendChild(adEl);
            (adsbygoogle = window.adsbygoogle || []).push({});
            // Track impression for the preceding post
            db.ref(`post_impressions/${postId}`).transaction(count => (count || 0) + 1);
          }

          // Post Event Listeners
          if (!isOwnPost) {
            const followBtn = postEl.querySelector('.follow-btn');
            const followRef = db.ref(`follows/${currentUser.uid}/${post.uid}`);
            followRef.once('value', snap => {
              if (!snap.exists()) followBtn.classList.remove('hidden');
            });
            followBtn?.addEventListener('click', () => {
              db.ref(`follows/${currentUser.uid}/${post.uid}`).set(true);
              followBtn.classList.add('hidden');
              alert(`You followed ${post.name}`);
            });
          }
          db.ref(`likes/${postId}`).on('value', snap => {
            const likes = snap.val() || {};
            document.getElementById(`like-count-${postId}`).textContent = Object.keys(likes).length;
          });
          db.ref(`reposts/${postId}`).on('value', snap => {
            const reposts = snap.val() || {};
            document.getElementById(`repost-count-${postId}`).textContent = Object.keys(reposts).length;
          });
          db.ref(`reposts/${postId}/${currentUser.uid}`).once('value', snap => {
            if (snap.exists()) postEl.querySelector('.repost-btn').classList.add('reposted');
          });
          postEl.querySelector('.like-btn').addEventListener('click', () => {
            const likeRef = db.ref(`likes/${postId}/${currentUser.uid}`);
            likeRef.once('value', snap => {
              if (snap.exists()) likeRef.remove();
              else likeRef.set(true);
            });
          });
          postEl.querySelector('.comment-btn').addEventListener('click', () => {
            const input = postEl.querySelector(`.comment-input[data-id="${postId}"]`);
            const text = input.value.trim();
            if (!text) return;
            db.ref(`comments/${postId}`).push({
              uid: currentUser.uid,
              name: currentUser.displayName || 'User',
              avatar: currentUser.photoURL || `https://i.pravatar.cc/150?u=${currentUser.uid}`,
              text,
              timestamp: Date.now()
            });
            input.value = '';
          });
          const deleteBtn = postEl.querySelector('.delete-post-btn');
          if (deleteBtn) {
            deleteBtn.addEventListener('click', () => {
              if (confirm('Delete this post?')) {
                db.ref(`posts/${postId}`).remove();
                db.ref(`likes/${postId}`).remove();
                db.ref(`comments/${postId}`).remove();
                db.ref(`reposts/${postId}`).remove();
                db.ref(`post_impressions/${postId}`).remove();
              }
            });
          }
          const editBtn = postEl.querySelector('.edit-post-btn');
          if (editBtn) {
            editBtn.addEventListener('click', () => {
              const newContent = prompt('Edit your post:', post.content);
              const newImageUrl = prompt('Edit image URL (optional, leave blank to remove):', post.imageUrl || '');
              if (newContent && newContent !== post.content) {
                const updates = { content: newContent };
                if (newImageUrl) updates.imageUrl = newImageUrl;
                else if (post.imageUrl) updates.imageUrl = null;
                db.ref(`posts/${postId}`).update(updates);
              }
            });
          }
          loadComments(postId);
        }
      });
    }

    // Repost Event Listener
    document.getElementById('posts').addEventListener('click', async (event) => {
      if (event.target.closest('.repost-btn')) {
        const button = event.target.closest('.repost-btn');
        const postId = button.getAttribute('data-id');
        const postRef = db.ref('posts/' + postId);
        const repostRef = db.ref(`reposts/${postId}/${auth.currentUser?.uid}`);

        try {
          const repostSnapshot = await repostRef.once('value');
          if (repostSnapshot.exists()) {
            alert('You have already reposted this post.');
            return;
          }
          const snapshot = await postRef.once('value');
          if (!snapshot.exists()) {
            alert('Post not found.');
            return;
          }
          const originalPost = snapshot.val();
          const currentUser = auth.currentUser;
          if (!currentUser) {
            alert('Please log in to repost.');
            return;
          }
          const newPost = {
            content: originalPost.content,
            uid: currentUser.uid,
            name: currentUser.displayName || 'Anonymous',
            avatar: currentUser.photoURL || `https://i.pravatar.cc/150?u=${currentUser.uid}`,
            originalPostId: postId,
            timestamp: Date.now()
          };
          if (originalPost.imageUrl) newPost.imageUrl = originalPost.imageUrl;
          await db.ref('posts').push(newPost);
          await repostRef.set(true);
          button.classList.add('reposted');
          alert('Reposted!');
        } catch (err) {
          console.error('Repost error:', err);
          alert('Failed to repost. Please try again.');
        }
      }
    });

    // Other Functions (unchanged)
    function loadReels() { /* Unchanged */ }
    function formatTimestamp(timestamp) { /* Unchanged */ }
    function loadComments(postId) { /* Unchanged */ }
    function bindPostCounter() { /* Unchanged */ }
    // Create Modal, Post Modal, Reel Modal, Reel Viewer Modal (unchanged)
  </script>
</body>
</html>
