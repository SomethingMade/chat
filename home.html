<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Loopa Feed</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    ::-webkit-scrollbar {
      display: none;
    }

   .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #ffffff;
      box-shadow: 0 -1px 10px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-around;
      align-items: center;
      height: 60px;
      border-top-left-radius: 12px;
      border-top-right-radius: 12px;
      z-index: 1000;
    }

    .bottom-nav a {
      flex: 1;
      text-align: center;
      color: #777;
      text-decoration: none;
      font-size: 12px;
      padding: 8px 0 4px;
      transition: color 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .bottom-nav a svg {
      width: 24px;
      height: 24px;
      margin-bottom: 2px;
      fill: #777;
      transition: fill 0.3s ease;
    }

    .bottom-nav a.active,
    .bottom-nav a:hover {
      color: #000000; /* blue */
    }

    .bottom-nav a.active svg,
    .bottom-nav a:hover svg {
      fill: #000000;
    }

    /* Optional: Add a little pulse effect on active */
    .bottom-nav a.active svg {
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }


.drawer-link { @apply text-[17px] font-medium text-gray-700 hover:text-blue-600; }



  </style>


  </style>
</head>
<body class="bg-gradient-to-b from-white to-gray-100 min-h-screen text-gray-800">


<header class="flex items-center justify-between px-4 h-14 bg-white shadow">
  <button id="burger"
          class="p-2 focus:outline-none">
    <!-- simple hamburger icon -->
    <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2"
         viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round"
            d="M4 6h16M4 12h16M4 18h16"/>
    </svg>
  </button>
  <h1 class="font-semibold text-lg">Loopa</h1>
  <!-- keep space-balanced -->
  <div class="w-6"></div>
</header>

<!-- 2️⃣  Overlay + Drawer container -->
<div id="overlay"
     class="fixed inset-0 bg-black/40 opacity-0 pointer-events-none transition-opacity duration-300 z-30"></div>

<aside id="drawer"
       class="fixed inset-y-0 left-0 w-64 max-w-[80%] -translate-x-full
              bg-white shadow-lg overflow-y-auto transition-transform duration-300 z-40">
  <!-- Drawer content -->
  <div class="p-4 space-y-6">
    <div class="text-xl font-bold">Menu</div>

    <!-- profile snippet (optional) -->
    <div class="flex items-center space-x-3">
      <img src="https://i.pravatar.cc/40" alt="avatar" class="rounded-full w-10 h-10"/>
      <div>
        <p class="font-medium">Hi, Student!</p>
        <a href="profile.html" class="text-sm text-blue-600">View profile</a>
      </div>
    </div>

    <nav class="flex flex-col space-y-4">
      <a href="home.html"   class="drawer-link">Home</a>
      <a href="ride.html"  class="drawer-link">Get a Ride</a>
      <a href="study.html"  class="drawer-link">Study Materials</a>
      <a href="chat.html"   class="drawer-link">Search For Friends</a>
      <a href="requests.html" class="drawer-link">Requests</a>
      <hr/>
      <a href="settings.html" class="drawer-link">Settings</a>
      <button class="drawer-link text-red-600 text-left">Log out</button>
    </nav>
  </div>
</aside>





  <!-- Container -->
  <div class="max-w-md mx-auto p-4">
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
       <img src="loopa.png" alt="Your Logo" class="h-12 w-12 rounded-full mr-3" />
      <div class="flex justify-center gap-4 mt-4">
  <div class="flex justify-center gap-6 mt-6">
  <!-- Ride Sharing -->
  <button class="flex flex-col items-center p-4 bg-blue-100 rounded-xl hover:bg-blue-200">
    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path d="M16 3H8a5 5 0 00-5 5v8a3 3 0 003 3v1a1 1 0 001 1h2a1 1 0 001-1v-1h4v1a1 1 0 001 1h2a1 1 0 001-1v-1a3 3 0 003-3V8a5 5 0 00-5-5zM3 13h18M7 16h.01M17 16h.01"/>
    </svg>
    <span class="text-sm mt-2 text-blue-700 font-medium">Get Ride</span>
  </button>

  <!-- Market -->
  <button class="flex flex-col items-center p-4 bg-green-100 rounded-xl hover:bg-green-200">
    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path d="M6 2L3 6v13a2 2 0 002 2h14a2 2 0 002-2V6l-3-4zM3 6h18M16 10a4 4 0 01-8 0"/>
    </svg>
    <span class="text-sm mt-2 text-green-700 font-medium">Market</span>
  </button>

  <!-- Events -->
  <button class="flex flex-col items-center p-4 bg-purple-100 rounded-xl hover:bg-purple-200">
    <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path d="M8 2v4M16 2v4M3 10h18M5 20h14a2 2 0 002-2V7H3v11a2 2 0 002 2z"/>
    </svg>
    <span class="text-sm mt-2 text-purple-700 font-medium">Events</span>
  </button>
</div>

</div>
    </div>


<!-- 🔵 Create Reel Button -->
<div class="flex items-center justify-between mb-2 px-2">
  <h2 class="text-lg font-semibold">Just Reels</h2>
  <button id="createReelBtn" class="bg-black text-white text-sm px-4 py-1 rounded-full hover:bg-gray-800 transition">
  + Create Reel
</button>
  
<a href="aichat.html">
<button id="ai-button" class="bg-black text-white text-sm px-4 py-1 rounded-full hover:bg-gray-800 transition flex items-center space-x-1">
  <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
    <!-- Robot head icon -->
    <rect x="6" y="8" width="12" height="8" rx="2" ry="2" />
    <circle cx="9" cy="12" r="1" fill="currentColor" />
    <circle cx="15" cy="12" r="1" fill="currentColor" />
    <path d="M12 16v2" stroke-linecap="round"/>
  </svg>
  <span>AI</span>
</button>
</a>
</div>

<!-- 🟣 Text Reel Modal -->
<div id="reelInputModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 hidden">
  <div class="bg-white p-6 rounded-xl shadow-xl w-80">
    <h3 class="text-lg font-semibold mb-2">Create a Reel</h3>
    <textarea id="reelText" placeholder="What's on your mind?" maxlength="100"
      class="w-full border p-2 rounded-md resize-none mb-4"></textarea>
    <div class="flex justify-end space-x-2">
      <button id="cancelReel" class="px-4 py-1 bg-black text-white rounded-full hover:bg-gray-800 transition">Cancel</button>
<button id="postReel" class="px-4 py-1 bg-black text-white rounded-full hover:bg-gray-800 transition">Post</button>

    </div>
  </div>
</div>

<!-- 🔴 Reels Container -->
<div class="overflow-x-auto whitespace-nowrap px-4 reels-container flex space-x-4">
  <!-- Reels will be loaded here by JavaScript -->
</div>



    <!-- Post Form -->
    <div class="bg-white rounded-2xl shadow-md p-4 mb-6 border border-gray-100">
      <textarea id="postInput" placeholder="What's on your mind?" class="w-full text-sm p-3 border border-gray-200 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 outline-none mb-2" rows="3"></textarea>
      <!-- Post Button with Icon -->
<button id="postBtn" class="w-full bg-black hover:bg-gray-900 text-white font-medium py-2 px-4 rounded-full flex items-center justify-center gap-2 transition">
  <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
  </svg>
  Post
</button>

    </div>

    <!-- Feed -->
    <div class="max-w-md mx-auto p-4 pb-24">
    <div id="posts" class="space-y-6"></div>
  </div>

 <div class="bottom-nav" role="navigation" aria-label="Bottom Navigation">
   <a href="#home" class="active relative" aria-current="page">
  <!-- Home Icon -->
  <svg viewBox="0 0 24 24" aria-hidden="true">
    <path d="M3 12l9-9 9 9v9a3 3 0 0 1-3 3h-4v-6H10v6H6a3 3 0 0 1-3-3v-9z"/>
  </svg>
  Home
  <!-- 🔴 badge -->
  <span id="postCountBadge"
        class="absolute -top-1 -right-3 hidden min-w-[20px] px-1.5 rounded-full
               bg-red-600 text-white text-[10px] leading-4 text-center"></span>
</a>


    <a href="profile.html">
      <!-- Profile Icon -->
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10zm0 2c-4 0-7 2-7 4v2h14v-2c0-2-3-4-7-4z"/>
      </svg>
      Profile
    </a>

    <a href="chat.html">
      <!-- Chat Icon -->
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M4 4h16v12H5.17L4 17.17V4z"/>
      </svg>
      Chat
    </a>

  <a href="requests.html" class="flex items-center space-x-2">
  <!-- Friends Request Icon (people/group icon) -->
  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24" aria-hidden="true">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a4 4 0 00-3-3.87M9 20H4v-2a4 4 0 013-3.87M12 12a4 4 0 100-8 4 4 0 000 8zM16 7a4 4 0 110 8M9 12a7 7 0 00-7 7v1h7v-1a7 7 0 00-7-7z" />
  </svg>
  <span>Requests</span>
</a>





  <!-- Scripts -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBOyZ3As4GTuNvjemvPF_SpsC6m6vqtNhc",
      authDomain: "fire-b-a8878.firebaseapp.com",
      databaseURL: "https://fire-b-a8878.firebaseio.com",
      projectId: "fire-b-a8878",
      storageBucket: "fire-b-a8878.appspot.com",
      messagingSenderId: "658673187627",
      appId: "1:658673187627:web:6e4c29af661785f0afa36e"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.database();

    const postInput = document.getElementById("postInput");
    const postBtn = document.getElementById("postBtn");
    const postsContainer = document.getElementById("posts");

    let currentUser = null;

    auth.onAuthStateChanged(user => {
      if (!user) return window.location.href = "index.html";
      currentUser = user;
      loadPosts();
    });

  // Button Elements
  const createReelBtn = document.getElementById('createReelBtn');
  const reelModal = document.getElementById('reelInputModal');
  const cancelReel = document.getElementById('cancelReel');
  const postReel = document.getElementById('postReel');
  const reelTextInput = document.getElementById('reelText');

  // Modal Open/Close
  createReelBtn.addEventListener('click', () => reelModal.classList.remove('hidden'));
  cancelReel.addEventListener('click', () => {
    reelModal.classList.add('hidden');
    reelTextInput.value = '';
  });

  // Post Reel to Firebase
  postReel.addEventListener('click', () => {
    const text = reelTextInput.value.trim();
    if (!text) return;

    const user = firebase.auth().currentUser;
    if (!user) return alert("Please log in to post a reel.");

    const reelData = {
      name: user.displayName || 'Anonymous',
      uid: user.uid,
      text: text,
      timestamp: Date.now()
    };

    firebase.database().ref("reels").push(reelData).then(() => {
      reelModal.classList.add('hidden');
      reelTextInput.value = '';
    });
  });

  // Load Reels from Firebase and remove those older than 24h
  function loadReels() {
    const reelsContainer = document.querySelector('.reels-container');
    const now = Date.now();

    firebase.database().ref("reels").on("value", snapshot => {
      reelsContainer.innerHTML = '';
      const reels = snapshot.val() || {};

      Object.entries(reels).forEach(([id, reel]) => {
        const age = now - reel.timestamp;

        if (age > 86400000) { // 24 hours = 86400000 ms
          // Delete expired reel
          firebase.database().ref("reels/" + id).remove();
        } else {
          // Display reel
          const reelEl = document.createElement('div');
          reelEl.className = 'flex-shrink-0 text-center';
          reelEl.innerHTML = `
            <div class="w-16 h-16 rounded-full bg-gradient-to-br from-pink-500 to-yellow-500 flex items-center justify-center text-white text-xs text-center p-2 overflow-hidden">
              ${reel.text.length > 30 ? reel.text.slice(0, 28) + "…" : reel.text}
            </div>
            <p class="text-xs mt-1 truncate w-16">${reel.name}</p>
          `;
          reelsContainer.appendChild(reelEl);
        }
      });
    });
  }

  // Initialize on page load
  firebase.auth().onAuthStateChanged(user => {
    if (user) {
      loadReels();
    }
  });


    postBtn.addEventListener("click", () => {
      const content = postInput.value.trim();
      if (!content) return;
      const postRef = db.ref("posts").push();
      postRef.set({
        uid: currentUser.uid,
        name: currentUser.displayName || "Anonymous",
        email: currentUser.email,
        avatar: currentUser.photoURL || `https://i.pravatar.cc/150?u=${currentUser.uid}`,
        content,
        timestamp: Date.now()
      });
      postInput.value = "";
    });

function formatTimestamp(timestamp) {
  const now = new Date();
  const postDate = new Date(timestamp);
  const diffMs = now - postDate;
  const diffMinutes = Math.floor(diffMs / 60000);
  const diffHours = Math.floor(diffMs / 3600000);
  const diffDays = Math.floor(diffMs / 86400000);

  if (diffMinutes < 1) return "Just now";
  if (diffMinutes < 60) return `${diffMinutes} min${diffMinutes > 1 ? "s" : ""} ago`;
  if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? "s" : ""} ago`;
  if (diffDays === 1) return `Yesterday at ${postDate.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}`;
  if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? "s" : ""} ago`;

  return postDate.toLocaleDateString(undefined, {
    month: "short",
    day: "numeric",
    year: "numeric",
    hour: "2-digit",
    minute: "2-digit"
  });
}




    function loadPosts() {
      db.ref("posts").on("value", snapshot => {
        const posts = snapshot.val() || {};
        postsContainer.innerHTML = "";

        Object.entries(posts).reverse().forEach(([postId, post]) => {



          const postEl = document.createElement("div");
          postEl.className = "bg-white rounded-2xl shadow p-4 border border-gray-100";

          postEl.innerHTML = `
            <div class="flex items-center gap-3 mb-3">
              <img src="${post.avatar}" class="w-10 h-10 rounded-full object-cover"/>
              <div class="flex-1">
                <p class="font-semibold text-sm">${post.name}</p>
                <span class="text-xs text-gray-400">${formatTimestamp(post.timestamp)}</span>

              </div>
              ${post.uid === currentUser.uid ? `
              <div class="flex gap-2 text-xs">
                <button class="edit-post-btn bg-black hover:bg-gray-900 text-white px-3 py-1 rounded-full text-xs flex items-center justify-center" data-id="${postId}" title="Edit">
  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11.5A1.5 1.5 0 005.5 20H17a2 2 0 002-2v-5M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z" />
  </svg>
</button>

<button class="delete-post-btn bg-black hover:bg-gray-900 text-white px-3 py-1 rounded-full text-xs flex items-center justify-center" data-id="${postId}" title="Delete">
  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
  </svg>
</button>

              </div>` : ""}
            </div>

            <p class="mb-3 text-sm leading-relaxed" id="content-${postId}">${post.content}</p>

            <div class="flex items-center gap-3 text-xs text-gray-500 mb-2">
            <button class="like-btn bg-black hover:bg-red-600 text-white p-2 rounded-full transition" data-id="${postId}" title="Like">
  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 
             2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 
             4.5 2.09C13.09 3.81 14.76 3 
             16.5 3 19.58 3 22 5.42 22 
             8.5c0 3.78-3.4 6.86-8.55 
             11.54L12 21.35z"/>
  </svg>
</button>

              <span id="like-count-${postId}" class="text-gray-600">0</span>

<button class="repost-btn text-gray-500 hover:text-black p-1 rounded-full" data-id="${postId}" title="Repost">
  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
      d="M17 1l4 4-4 4M3 11v-2a4 4 0 014-4h14M7 23l-4-4 4-4M21 13v2a4 4 0 01-4 4H3" />
  </svg>
</button>



            </div>

            <div id="comments-${postId}" class="ml-4 space-y-2 text-sm"></div>

            <div class="flex items-center gap-2 mt-3">
                <input
    type="text"
    placeholder="Write a comment..."
    class="comment-input flex-1 border border-gray-300 rounded-full px-4 py-2 text-sm focus:ring focus:ring-black/20 focus:outline-none"
    data-id="${postId}"
  />
  <button
    class="comment-btn bg-black hover:bg-gray-900 text-white p-2 rounded-full"
    data-id="${postId}"
    title="Post Comment"
  >
    <!-- Send (paper plane) icon -->
    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M3 10l9-6 9 6-9 6-9-6z" />
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M9 21V9l3-2 3 2v12" />
    </svg>
  </button>
            </div>
          `;

          postsContainer.appendChild(postEl);

          db.ref(`likes/${postId}`).on("value", snap => {
            const likes = snap.val() || {};
            document.getElementById(`like-count-${postId}`).textContent = Object.keys(likes).length;
          });

          postEl.querySelector(".like-btn").addEventListener("click", () => {
            const likeRef = db.ref(`likes/${postId}/${currentUser.uid}`);
            likeRef.once("value", snap => {
              if (snap.exists()) likeRef.remove();
              else likeRef.set(true);
            });
          });

          loadComments(postId);

          postEl.querySelector(".comment-btn").addEventListener("click", () => {
            const input = postEl.querySelector(`.comment-input[data-id="${postId}"]`);
            const text = input.value.trim();
            if (!text) return;
            db.ref(`comments/${postId}`).push({
              uid: currentUser.uid,
              name: currentUser.displayName || "User",
              avatar: currentUser.photoURL || `https://i.pravatar.cc/150?u=${currentUser.uid}`,
              text,
              timestamp: Date.now()
            });
            input.value = "";
          });

          const deleteBtn = postEl.querySelector(".delete-post-btn");
          if (deleteBtn) {
            deleteBtn.addEventListener("click", () => {
              if (confirm("Delete this post?")) {
                db.ref(`posts/${postId}`).remove();
                db.ref(`likes/${postId}`).remove();
                db.ref(`comments/${postId}`).remove();
              }
            });
          }

          const editBtn = postEl.querySelector(".edit-post-btn");
          if (editBtn) {
            editBtn.addEventListener("click", () => {
              const newContent = prompt("Edit your post:", post.content);
              if (newContent && newContent !== post.content) {
                db.ref(`posts/${postId}/content`).set(newContent);
              }
            });
          }
        });
      });
    }

    function loadComments(postId) {
      const container = document.getElementById(`comments-${postId}`);
      db.ref(`comments/${postId}`).on("value", snapshot => {
        const comments = snapshot.val() || {};
        container.innerHTML = "";

        Object.entries(comments).forEach(([key, cmt]) => {
          const commentEl = document.createElement("div");
          commentEl.className = "flex items-start gap-2";

          commentEl.innerHTML = `
            <img src="${cmt.avatar}" class="w-6 h-6 rounded-full mt-1"/>
            <div class="bg-gray-100 px-3 py-2 rounded-xl w-full">
              <div class="flex justify-between items-center mb-1">
                <span class="font-medium text-xs">${cmt.name}</span>
                ${cmt.uid === currentUser.uid ? `<button class="delete-comment text-red-400 text-xs" data-id="${key}">Delete</button>` : ""}
              </div>
              <p class="text-xs">${cmt.text}</p>
             <p class="text-[10px] text-gray-400 mt-1">${new Date(cmt.timestamp).toLocaleTimeString()}</p>
            </div>
          `;

          container.appendChild(commentEl);

          const delBtn = commentEl.querySelector(".delete-comment");
          if (delBtn) {
            delBtn.addEventListener("click", () => {
              db.ref(`comments/${postId}/${key}`).remove();
            });
          }
        });
      });
    }

// Add repost button functionality
document.querySelectorAll(".repost-btn").forEach(button => {
  button.addEventListener("click", async () => {
    const postId = button.getAttribute("data-id");
    const postRef = db.ref("posts/" + postId);

    try {
      const snapshot = await postRef.get();
      if (!snapshot.exists()) {
        alert("Post not found.");
        return;
      }

      const originalPost = snapshot.val();
      const currentUser = auth.currentUser;

      // Create new post with original content
      const newPost = {
        content: originalPost.content,
        userId: currentUser.uid,
        userName: currentUser.displayName || "Anonymous",
        userAvatar: currentUser.photoURL || "",
        originalPostId: postId,
        repostedAt: Date.now(),
        createdAt: Date.now()
      };

      await db.ref("posts").push(newPost);
      alert("Reposted!");
    } catch (err) {
      console.error("Repost error:", err);
    }
  });
});


const burger  = document.getElementById('burger');
const overlay = document.getElementById('overlay');
const drawer  = document.getElementById('drawer');

function openDrawer() {
  drawer.classList.remove('-translate-x-full');
  overlay.classList.remove('opacity-0', 'pointer-events-none');
}
function closeDrawer() {
  drawer.classList.add('-translate-x-full');
  overlay.classList.add('opacity-0', 'pointer-events-none');
}
burger.addEventListener('click', openDrawer);
overlay.addEventListener('click', closeDrawer);

// close when a link is clicked (optional)
drawer.querySelectorAll('.drawer-link').forEach(link => {
  link.addEventListener('click', closeDrawer);
});


// 📊 Live post counter
function bindPostCounter() {
  const badge = document.getElementById('postCountBadge');

  // Listen for any change in /posts
  db.ref('posts').on('value', snap => {
    const count = snap.numChildren();

    if (count === 0) {
      badge.classList.add('hidden');
    } else {
      badge.textContent = count > 99 ? '99+' : count; // cap at 99+
      badge.classList.remove('hidden');
    }
  });
}

// Bind after user auth or right after Firebase init
bindPostCounter();







  </script>
</body>
</html>



